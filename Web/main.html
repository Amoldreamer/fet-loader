<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="jquery-3.4.1.min.js"></script>
  <!-- Bootstrap -->
  <link href="bootstrap-4.4.1.css" rel="stylesheet">
  <link href="buttons.css" rel="stylesheet" type="text/css">
</head>

<body>
  <!-- Title Bar -->
  <header>
    <div class="d-flex align-items-stretch bg-dark text-white">
      <span class="flex-grow-1 px-2 py-1" onmousedown="neutron.DragTitleBar()">AYE Loader</span>
      <span class="title-btn title-btn-close mr-2 mt-1" onclick="neutron.Close()">X</span>
    </div>
  </header>
  <!-- End Title Bar -->

  <div id="inject">
    <button type="button" class="btn btn-outline-primary btn-inject" value="inject" id="inject_button"
      onClick="ahk.Inject(GetSelectedCheat())" disabled=true>Инжект</button>
  </div>

  <div id="cheatslist">
    <div class="btn-group-vertical btn-group-toggle ml-3 mt-3" data-toggle="buttons" id="cheats">
      <script>
        function getText() {
          var xmlHttp = new XMLHttpRequest();
          xmlHttp.open("GET", "https://raw.githubusercontent.com/clangremlini/ayeloader-dll-repo/master/cheats.ini", false); // false for synchronous request
          xmlHttp.send(null);
          return xmlHttp.responseText;
        }

        function parseINIString(data) {
          var regex = {
            section: /^\s*\[\s*([^\]]*)\s*\]\s*$/,
            param: /^\s*([\w\.\-\_]+)\s*=\s*(.*?)\s*$/,
            comment: /^\s*;.*$/
          };
          var value = {};
          var lines = data.split(/\r\n|\r|\n/);
          var section = null;

          for (x = 0; x < lines.length; x++) {

            if (regex.comment.test(lines[x])) {
              return;
            } else if (regex.param.test(lines[x])) {
              var match = lines[x].match(regex.param);
              if (section) {
                value[section][match[1]] = match[2];
              } else {
                value[match[1]] = match[2];
              }
            } else if (regex.section.test(lines[x])) {
              var match = lines[x].match(regex.section);
              value[match[1]] = {};
              section = match[1];
            } else if (lines.length == 0 && section) {//changed line to lines to fix bug.
              section = null;
            };

          }

          return value;
        }

        function createCheatsButtons() {
          var cheats = parseINIString(getText())["cheatlist"]["cheatlist"].split("|");
          console.log(cheats);
          var cheats_div = document.getElementById("cheats");
          for (cheat in cheats) {
            cheats_div.innerHTML += "<label class=\"btn btn-outline-primary\"><input type=\"radio\" name=\"cheat\" value=\"" + cheats[cheat] + "\" autocomplete=\"off\" onclick='CheatButtonClicked()'> " + cheats[cheat] + " </label>";
          }
        }
        createCheatsButtons();
      </script>
    </div>
  </div>

  <script type="text/javascript">
    function GetSelectedCheat() {
      var radioValue = $("input[name='cheat']:checked").val();
      return radioValue;
    };
  </script>
  <script>
    function CheatButtonClicked() {
      document.getElementById("inject_button").disabled = false;
    }
  </script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="popper.min.js"></script>
  <script src="bootstrap-4.4.1.js"></script>

</body>

</html>